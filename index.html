<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Novel Studio</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="main-container">
    <div class="sync-status" id="sync-status">연결 중...</div>
    
    <input type="text" id="novel-title" placeholder="전체 제목을 입력하세요">
    
    <div class="editor-wrapper">
        <div class="youtube-panel" id="youtube-panel">
            <input type="text" id="youtube-input" placeholder="YouTube 영상 또는 재생목록 링크 붙여넣기">
            <div class="youtube-player">
                <iframe id="youtube-iframe" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            <div class="resize-handle" id="youtube-resize-handle"></div>
        </div>
        
        <div class="editor-area">
            <input type="text" id="section-title" placeholder="섹션 제목 (선택사항)">
            <textarea id="novel-editor" placeholder="이곳에 글을 쓰면 자동으로 클라우드에 저장됩니다."></textarea>
            <div id="markdown-preview" class="markdown-preview hidden">
                <div class="preview-notice">📖 읽기 전용 모드 — 편집하려면 "편집 모드" 버튼을 누르세요</div>
                <div id="preview-content"></div>
            </div>
        </div>
        
        <div class="section-sidebar">
            <div class="section-list" id="section-list"></div>
            <button class="add-section-btn" onclick="addSection()">+ 새 섹션</button>
        </div>
    </div>
    
    <div class="view-toggle">
        <button id="toggle-view-btn" onclick="toggleView()">마크다운 보기</button>
        <div class="move-text-wrapper">
            <button id="move-text-btn" onclick="toggleMoveDropdown()" disabled>선택 영역 이동</button>
            <div id="move-dropdown" class="move-dropdown hidden"></div>
        </div>
    </div>

    <div class="status-bar">
        <div class="count-toggles">
            <button id="scope-toggle" onclick="toggleScope()">현재 섹션</button>
            <button id="space-toggle" onclick="toggleSpace()">공백 포함</button>
        </div>
        <span><span id="char-count" class="count-value">0</span> 자</span>
    </div>

    <div class="link-controls">
        <span class="link-label">저장 링크:</span>
        <button class="link-btn" id="link-toggle-btn" onclick="toggleLinkBox()">🔗 보기</button>
        <button class="link-btn" id="link-copy-btn" onclick="copyLinkDirect()">📋 복사</button>
    </div>
    
    <div class="link-box hidden" id="link-box">
        <span>내 저장 링크:</span>
        <input type="text" id="my-link" readonly onclick="this.select()">
    </div>

    <button class="file-toggle-btn" id="file-toggle-btn" onclick="toggleFileControls()">📁 파일 관리 ▼</button>
    
    <div id="file-controls" class="hidden">
        <div class="btn-group">
            <button class="action-btn import-btn" onclick="triggerImport()">전체 파일 불러오기</button>
            <button class="action-btn export-btn" onclick="exportTxt()">전체 파일로 저장</button>
        </div>
        
        <div class="btn-group">
            <button class="action-btn import-btn" onclick="triggerSectionImport()">섹션 파일 불러오기</button>
            <button class="action-btn export-btn" onclick="exportSectionTxt()">현재 섹션 저장</button>
        </div>
    </div>
    
    <input type="file" id="file-input" accept=".txt" onchange="handleFileSelect(event)">
    <input type="file" id="section-file-input" accept=".txt" onchange="handleSectionFileSelect(event)">
</div>

<div id="toast">알림</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="script.js"></script>

</body>
</html>
